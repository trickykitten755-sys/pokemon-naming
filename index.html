<!DOCTYPE html>
<html>
<head>
  <title>No-Repeat Pokémon Run</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #111;
      color: white;
      font-family: Arial;
      flex-direction: column;
    }

    img {
      width: 200px;
      height: 200px;
      image-rendering: pixelated;
    }
  </style>
</head>

<body>

<h2>Press SPACE for a random Pokémon (no repeats per run)</h2>
<img id="sprite" src="" alt="Pokémon sprite">

<script>
const sprite = document.getElementById("sprite");
const TOTAL_POKEMON = 1025;

let pool = [];

// Fisher–Yates shuffle
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// Create a new run
function resetPool() {
  pool = Array.from({ length: TOTAL_POKEMON }, (_, i) => i + 1);
  shuffle(pool);
  console.log("New run started!");
}

async function showNextPokemon() {
  if (pool.length === 0) resetPool();

  const id = pool.pop();

  try {
    const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
    const data = await response.json();

    sprite.src = data.sprites.front_default;
  } catch (err) {
    console.error("Error fetching Pokémon:", err);
  }
}

// Start first run
resetPool();

document.addEventListener("keydown", (event) => {
  if (event.code === "Space") {
    event.preventDefault();
    showNextPokemon();
  }
});
</script>

</body>
</html>
